\section{Homophily: \emph{"Birds of a feather flock together"}}
\label{sec:homophily}
%\vspace{-0.2cm}
%\begin{center} \emph{Birds of a feather flock together} \end{center}
%\vspace{0.1cm}

Homophily refers to the tendency of individuals to connect to similar others: two individuals (and thus their corresponding nodes in a social network) are more likely to be connected if they share common characteristics~\cite{mcpherson2001birds,lazarsfeld1954friendship}. The characteristics often considered are inherent to the individuals: they may represent their social status, their preferences, their interest, ... A related notion is the one of {\it assortativity}, which is slightly more general as it applies to any network, and not just social networks, and refers to the tendency of nodes in networks to be connected to others that are similar in some way.

A definition of homophily has been proposed in~\cite{la2010randomization}. However, this definition, which relies on a single characteristic (as age or gender), does not allow one to assess whether latent models for link prediction capture the homophily effect or not. We thus introduce a new definition of homophily below, which directly aims at this:
%
\begin{definition}[Homophily]
	Let $\mathcal{M}=\{\mathcal{M}_g,\mathcal{M}_e\}$ be a link prediction model as defined above and $s$ a similarity measure between nodes. We say that \emph{$\mathcal{M}$ captures the homophily effect} iff, $\forall (i,j,i',j') \in V^4$:
%
\begin{equation}
\begin{array}{l}
s(i,j) > s(i',j')  \implies \nonumber \\
\pr(y_{ij}=1 \mid \mathcal{M}) > \pr(y_{i'j'}=1  \mid \mathcal{M}) \nonumber
\end{array}
\end{equation}
%
A model which verifies this condition is said to be \emph{homophilic}.
\end{definition}
%
As one can note, this definition directly captures the effect "if two nodes are more similar, then they are more likely to be connected". The similarity function assesses to which extent two nodes share the same characteristics. In the case of $\mathcal{M}_e$, the parameters $\mat{\hat{F}}$ and $\mat{\hat{\Phi}}$ respectively capture the latent characteristics of nodes and the weights (or correlations) between the dimensions of these representations; a natural similarity between node characteristics is thus provided by:
%
\begin{equation}
s_e(i,j) = \mat{\hat{f}}_{i} \mat{\hat{\Phi}} \mat{\hat{f}}_j^\top
\label{eq:natural-sim}
\end{equation}
%
In the case of $\mathcal{M}_g$, one needs to generalize the above similarity by considering its expectation over $\mat{F}$ and $\mat{\Phi}$:
%
\begin{equation}
s_g(i,j) = \int_{\mat{\phi},\mat{f}_i,\mat{f}_j} \mat{f}_i \mat{\Phi} \mat{f}_j^\top \pr(\mat{\Phi},\mat{f}_i,\mat{f}_j|\mathcal{M}_g)  d\mat{\Phi}\mat{f}_i\mat{f}_j
\label{eq:natural-sim}
\end{equation}
%
From this, one can state the following property:
%
\begin{proposition}[] (1) $\mathcal{M}_g$ is homophilic wrt $s_g$; (2) $\mathcal{M}_e$ is homophilic wrt $s_e$.
\end{proposition}
%
\noindent \textbf{Proof} We prove (1), the proof for (1) being similar. We have:
%
\begin{equation}
\begin{array}{l}
\pr(y_{ij}=1|\mathcal{M}_g) = \int_{\mat{\Phi},\mat{f}_i,\mat{f}_j} \sum_{k,k'} \phi_{k,k'} \pr(z_{i \rightarrow j}=k|\mat{f}_i) \nonumber \\
\pr(z_{j \leftarrow i}=k'|\mat{f}_j) \pr(\mat{\Phi},\mat{f}_i,\mat{f}_j|\mathcal{M}_g)  d\mat{\Phi}\mat{f}_i\mat{f}_j \nonumber \\
= \int_{\mat{\Phi},\mat{f}_i,\mat{f}_j} \sum_{k,k'} \phi_{k,k'} f_{ik} f_{jk'} \pr(\mat{\Phi},\mat{f}_i,\mat{f}_j|\mathcal{M}_g)  d\mat{\Phi}\mat{f}_i\mat{f}_j \nonumber \\
= \int_{\mat{\Phi},\mat{f}_i,\mat{f}_j} \mat{f}_i \mat{\Phi} \mat{f}_j^\top \pr(\mat{\Phi},\mat{f}_i,\mat{f}_j|\mathcal{M}_g)  d\mat{\Phi}\mat{f}_i\mat{f}_j \nonumber \\
= s_g(i,j) \nonumber
\end{array}
\end{equation}
%
where $f_{ik}$ denotes the element of $\mat{F}$ at the $i^{th}$ row and $k^{th}$ column and where the second equality stems from the definitions of $z_{i \rightarrow j}$ and $z_{j \leftarrow i}$. This leads to the desired result. \hspace{5.5cm} $\Box$

The above development shows that the two versions of MMSB capture the homophily effect, with the "natural" similarities we have considered. We now turn to the preferential attachment effect.